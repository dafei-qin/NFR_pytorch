This is a customized version of **diffusion-net** from  ['github'](https://github.com/nmwsharp/diffusion-net).

We make minimum modifications to the layers.py to support running with different base vectors in the same batch.